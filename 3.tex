% Фильтр границ Канни, для чего используется, какие параметры за что отвечают.

Фильтр границ Канни (Кэнни) -- алгоритм, который среди всех пикселей изображения в градациях серого выделяет множество пикселей, которые образуют границы между объектами. Содержит следующие шаги:
\begin{enumerate}
\item
    Сглаживание изображения с целью устранения шума. Сглаживание выполняется путем сворачивания изображения с гауссовым ядром фиксированного размера: $I = H(\sigma) * I_0$. Слишком маленькие значения $\sigma$ не смогут убрать шум, что приведет к множеству ложноположительных срабатываний, а слишком большие превратят все изображение в слабо меняющийся градиент и уничтожат все границы.
\item
    Вычисление градиента, то есть полей частных производных яркости по двум координатам. Как правило, используется разностная схема размера $3 \times 3$, то есть свертка с ядром оператора Собеля:
    \begin{gather*}
        D_x = \begin{pmatrix}
            1 & 0 & -1\\
            2 & 0 & -2\\
            1 & 0 & -1
        \end{pmatrix},
        \quad
        D_y = D_x^T;\\
        G_x = D_x * I, \quad G_y = D_y * I. \\
    \end{gather*}
    Однако этот шаг может быть объединен с предыдущим: для этого нужно сворачивать исходное изображение с дифференцированным гауссовым ядром, то есть с дискретными приближениями $\partial_x h(0, \sigma), \partial_y h(0, \sigma)$.
\item
    По полученным значениям вычисляется массив абсолютных значений градиента ($G = \sqrt{G_x^2 + G_y^2}$, поэлементно) и массив направлений. Все направления округляются до одного из основных: вертикаль, горизонталь или одна из двух диагоналей, при этом сторона (влево или вправо) значения не имеет.
\item
    Все пиксели помечаются как границы или как не-границы по следующим правилам в указанном порядке:
    \begin{enumerate}
    \item
        Если элемент не является локальным максимумом в направлении \textit{своего} градиента, то элемент отмечается как не-граница. Например, если округленное направление градиента в $I_{ij}$ -- вертикаль, то $G_{ij} \le G_{i-1,j} \wedge G_{ij} \le G_{i+1,j} \implies B_{ij} = 0$, где $B$ -- выходной булев массив того же размера, что и изображение.
    \item
        Если модуль градиента $G_{ij} < \theta_{\mathrm{low}}$, то $B_{ij} = 0$.
    \item
        Если $G_{ij} > \theta_{\mathrm{high}}$, то $B_{ij} = 1$.
    \item
        В противном случае, если пиксель является локальным максимумом, но его абсолютное значение лежит между двумя пороговыми значениями, то он считается границей, если хотя бы один из 8 соседних был определен как граница с использованием предыдущего правила.
    \end{enumerate}
    
    Параметры $\theta_{\mathrm{low}}, \theta_{\mathrm{high}}$ регулируют количество ошибок обоих родов, но придать им какой-либо физический смысл довольно сложно.
\end{enumerate}

